# =============================== Redirects for the static website ================================
# Redirect all pages to website container
location / {
    proxy_pass        http://local_website_http;
    proxy_redirect    off;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
}

#============================== Redirects for the Chemistry Chatbot ===============================
# Main entry point for requests
location /marie/request/ {
    proxy_pass             http://local_chatbot/;
    proxy_set_header       Host $host;
    proxy_set_header       X-Real-IP $remote_addr;
    proxy_set_header       X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header       X-Forwarded-Host $server_name;
    proxy_set_header       X-Forwarded-Proto $scheme;
    proxy_connect_timeout  300;
    proxy_send_timeout     300;
    proxy_read_timeout     300;
    send_timeout           300;
}

# LDF server
location /marie/ldf/ {
    proxy_pass             http://local_ldf/;
    proxy_set_header       Host $host;
    proxy_set_header       X-Real-IP $remote_addr;
    proxy_set_header       X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header       X-Forwarded-Host $server_name;
    proxy_set_header       X-Forwarded-Proto $scheme;
    proxy_connect_timeout  300;
    proxy_send_timeout     300;
    proxy_read_timeout     300;
    send_timeout           300;
}

#========== Redirects for the UK Power Plant visualisation (part of the UK Digital Twin) ==========
# Main entry point for visualisation
location /digital-twin/power/ {
    proxy_pass             http://local_power_system/;
    proxy_set_header       Host $host;
    proxy_set_header       X-Real-IP $remote_addr;
    proxy_set_header       X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header       X-Forwarded-Host $server_name;
    proxy_set_header       X-Forwarded-Proto $scheme;
    proxy_connect_timeout  600;
    proxy_send_timeout     600;
    proxy_read_timeout     600;
    send_timeout           600;
}

# Resource files for visualisation
location /powersys/ {
    proxy_pass        http://local_power_system/powersys/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

#=========== Redirects for the UK Gas Grid visualisation (part of the UK Digital Twin) ============
location = /digital-twin/gas {
    return 302 $scheme://$http_host$uri/;
}

# Main entry point for visualisation
location /digital-twin/gas/ {
    proxy_pass        http://local_gas_grid/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

# Resource files for visualisation
location /geoJSON_assets/ {
    proxy_pass        http://local_gas_grid/geoJSON_assets/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

#======= Redirects for the UN Sustainable Goals visualisation (part of the UK Digital Twin) =======
location = /digital-twin/goals {
    return 302 $scheme://$http_host$uri/;
}

# Main entry point for visualisation
location /digital-twin/goals/ {
    proxy_pass        http://local_un_goals/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

#==================== Redirects for the Crop Map (part of the UK Digital Twin) ====================
location = /digital-twin/land-use {
    return 302 $scheme://$http_host$uri/;
}

# Main entry point for visualisation
location /digital-twin/land-use/ {
    proxy_pass        http://local_land_use/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

#==================================== Redirects for BlazeGraph ====================================
location = /blazegraph {
    return 302 $scheme://$http_host$uri/;
}
location /blazegraph/ {
    proxy_pass        http://db_blazegraph/blazegraph/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

#====================================== Redirects for RDF4J =======================================
# RDF4J server
location = /rdf4j-server {
    return 302 $scheme://$http_host$uri/;
}
location /rdf4j-server/ {
    proxy_pass        http://db_rdf4j/rdf4j-server/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}

# RDF4J workbench
location = /rdf4j-workbench {
    return 302 $scheme://$http_host$uri/;
}
location /rdf4j-workbench/ {
    proxy_pass        http://db_rdf4j/rdf4j-workbench/;
    proxy_set_header  Host $host;
    proxy_set_header  X-Real-IP $remote_addr;
    proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header  X-Forwarded-Host $server_name;
    proxy_set_header  X-Forwarded-Proto $scheme;
}
	
#======================== Redirects for other stuff (only for developers) =========================
# Folder containing CSVs on visitor stats
location = /dev/stats {
    return 302 /stats/;
}
location /dev/stats/ {
    return 301 /var/logs/nginx/persistent;
}
version: "3.8"

services:
  floodwarning_agent_debug:
    image: ghcr.io/cambridge-cares/floodwarning_agent_debug:1.0.0-SNAPSHOT
    environment:
      # Required environment variables for both Stack and "standalone" (i.e. outside stack) deployment
      - STACK_NAME=
      # Additional environment variables required for Stack deployment
      # (can be left blank for "standalone" deployment)
      - NAMESPACE=
      - DATABASE=
      # Additional environment variables required for "standalone deployment"
      # (can be left blank for Stack deployment)
      - DB_URL=jdbc:postgresql://host.docker.internal:9431/flood
      - DB_USER=postgres
      - DB_PASSWORD=postgres
      - QUERY_ENDPOINT=http://host.docker.internal:9999/blazegraph/namespace/flood/sparql
      - UPDATE_ENDPOINT=http://host.docker.internal:9999/blazegraph/namespace/flood/sparql
    build:
      # Path to dockerfile ('.' represents current directory with .yml file)
      context: .
      target: debug
    ports:
      - "5001:5000"
      - "5678:5678"
    volumes:
      - logs:/root/.jps
      - ./agent:/app/agent

volumes:
  logs:
    name: "logs"
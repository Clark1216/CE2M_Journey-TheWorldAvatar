# this import starts the gateway to the server. If this gateway is deleted the communication won't happen
from pubchem.kgoperations.javagateway import jpsBaseLibGW
from pyderivationagent.kg_operations import PySparqlClient


def test_data_query():
    query = """
    PREFIX dc: <http://purl.org/dc/elements/1.1/>
    SELECT ?z
    WHERE{
    ?x dc:title ?z . 
    } LIMIT 10
    """
    return query

def test_data_insert():
    query = """
    PREFIX dc: <http://purl.org/dc/elements/1.1/>
    INSERT DATA
    { 
      <http://example/book4> dc:title "New life" ;
                             dc:creator "Fist Last" .
    }
    """
    return query


if __name__ == '__main__' :
    sparqlEndPoint = 'http://www.theworldavatar.com/blazegraph/namespace/copy_ontospecies/sparql'
    kg_client = PySparqlClient(sparqlEndPoint,sparqlEndPoint)
    kg_client.performUpdate(test_data_insert())
    response = kg_client.performQuery(test_data_query()) 
    print(response)

